<!DOCTYPE html>
<html lang="es" >
  <head>
    <link rel="icon" type="image/png" href="favicon.png" />
    <meta charset="utf-8">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <meta name='viewport' content='width=device-width, initial-scale=1.0, shrink-to-fit=no,maximum-scale=1.0, user-scalable=0' />
    <link rel="stylesheet" href="node_modules/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="node_modules/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="node_modules/spectre.css/dist/spectre-icons.min.css">
    <link rel="stylesheet" href="node_modules/flexboxgrid/dist/flexboxgrid.min.css">
    <link rel="stylesheet" href="node_modules/@material/elevation/dist/mdc.elevation.min.css">
    <title>Bliblia -Es</title>
  </head>
  <body>
   

        <div class="row">
            <div class="col-xs-12 center-xs">
                <h1>Biblia</h1>
            </div>
        </div>
        <div class="divider"></div>


        <div class="row start-sm center-xs">
            <div class="col-xs-11 col-sm-3 col-sm-offset-1 center-xs">
                <div class="form-group">
                      <select onchange="changeLibro(event)" id="libros" class="form-select">
                      </select>
                </div>
                    <div class="form-group">
                      <select id="capitulos" class="form-select" >
                      </select>
                </div>
            </div>
        </div>
        <div class="divider"></div>
        <div class="row center-xs">
            <div class="col-xs-11 col-sm-10 start-xs" id="content">
                    
            </div>
        </div>




        <!-- form select control -->


<script src="node_modules/mithril/mithril.min.js"></script>
<script src="node_modules/underscore/underscore-min.js"></script>

<script>
 
var root = document.body
var content = document.getElementById("content");
var libros = document.getElementById("libros");


function changeLibro( event ){


    console.log( event.target.value );

}

m.request({
    method: "GET",
    url: "libros.json",
})
.then(function(data) {
    m.render(libros,data.map((_d)=>{
        return m("option",{value:_d.val},_d.text)
   }));
})




var Data = {
    todos: {
        capitulos: [],
        fetch: function() {
            m.request({
                method: "GET",
                url: "json/genesis.json",
            })
            .then(function(data){
                Data.todos.capitulos = data
            })
        }
    }
}



var Splash = {
    view: function() {
        return m("a", {href: "#!/genesis/12"}, m.router, )
    }
}

var Biblia = {
     oninit: Data.todos.fetch,
    view: function(vnode){

        const libro = vnode.attrs.libro || "genesis" ;
        const capitulo = vnode.attrs.capitulo || "1" ;

        console.log(vnode.attrs.libro);
        console.log()

        console.log(Data.todos.capitulos);


    
        return _.map(Data.todos.capitulos[capitulo],function(cap,iterator){
            
            return m("div",{class:"a"},[m("strong",iterator),m("p",cap)])
        })


       

    }
}


m.route(content, "/genesis/1", {
    "/:libro/:capitulo": Biblia
})


    // your code goes here!
    </script>
      
  </body>
  </html>